<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GeoRanks ‚Äî Upload Content</title>
  <link rel="stylesheet" href="css/home.css" />
  <link rel="stylesheet" href="css/game-modes.css" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to bottom right, #a7f3d0, #38bdf8);
      margin: 0;
      padding: 0;
    }

    .upload-container {
      max-width: 500px;
      margin: 120px auto 40px;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(14px);
      border-radius: 20px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: #111;
    }

    .subtitle {
      font-size: 1rem;
      color: #666;
      margin-bottom: 2rem;
    }

    .oauth-buttons {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .oauth-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 14px 20px;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: opacity 0.2s;
      color: white;
    }

    .oauth-btn:hover {
      opacity: 0.9;
    }

    .oauth-btn img {
      width: 24px;
      height: 24px;
    }

    .tiktok-btn {
      background: linear-gradient(135deg, #ff0050, #00f2ea);
    }

    .instagram-btn {
      background: linear-gradient(135deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
    }

    /* Instagram Manual Form */
    .instagram-form {
      display: none;
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      border: 2px solid #e6683c;
      text-align: left;
      animation: slideDown 0.3s ease;
    }

    .instagram-form.active {
      display: block;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .form-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .form-header h3 {
      margin: 0;
      color: #111;
      font-size: 1.2rem;
    }

    .close-form {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }

    .close-form:hover {
      background: rgba(0, 0, 0, 0.1);
    }

    .form-group {
      margin-bottom: 1.2rem;
    }

    .form-group label {
      display: block;
      font-weight: bold;
      color: #111;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .form-group input[type="text"] {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 1rem;
      font-family: 'Poppins', sans-serif;
      box-sizing: border-box;
      transition: border-color 0.2s;
    }

    .form-group input[type="text"]:focus {
      outline: none;
      border-color: #e6683c;
    }

    .image-upload {
      position: relative;
      cursor: pointer;
    }

    .upload-area {
      border: 2px dashed #ddd;
      border-radius: 10px;
      padding: 2rem;
      text-align: center;
      transition: all 0.2s;
      background: white;
    }

    .upload-area:hover {
      border-color: #e6683c;
      background: #fff5f3;
    }

    .upload-area.has-image {
      padding: 0;
      border: 2px solid #e6683c;
    }

    .upload-icon {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }

    .upload-text {
      font-size: 0.9rem;
      color: #666;
    }

    .image-preview {
      display: none;
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
      max-height: 200px;
    }

    .image-preview.active {
      display: block;
    }

    .submit-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #ff9770, #ff6f61);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: opacity 0.2s;
    }

    .submit-btn:hover {
      opacity: 0.9;
    }

    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .success-message,
    .error-message {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 10px;
      font-weight: 600;
      display: none;
    }

    .success-message {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .error-message {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .success-message.active,
    .error-message.active {
      display: block;
    }
  </style>
</head>
<body>

<!-- Header -->
<header class="home-glass-header">
  <div class="logo-header">
    <a href="index.html" class="logo-link">
      <img src="assets/logo.png" alt="GeoRanks Logo" />
    </a>
  </div>
  <div class="hamburger-menu">
    <div class="menu-icon" id="menuToggle">
      <span></span><span></span><span></span>
    </div>
  </div>
</header>

<!-- Sliding Menu -->
<div class="menu-overlay" id="menuOverlay">
  <div class="menu-panel">
    <h2>Menu</h2>
    <button class="menu-btn" onclick="window.location.href='index.html'">üè† Home</button>
    <button class="menu-btn menu-btn-account" onclick="window.location.href='account.html'">üë§ Account</button>
    <button class="menu-btn" onclick="window.location.href='categories.html'">üéÆ Categories</button>
    <button class="menu-btn" onclick="window.location.href='leaderboard.html'">üèÜ Leaderboard</button>
    <button class="menu-btn" onclick="window.location.href='stats.html'">üìä My Stats</button>
    <button class="menu-btn" onclick="window.location.href='how-to-play.html'">üí° How to Play</button>
    <button class="menu-btn" onclick="location.href='feedback.html'">üí¨ Feedback</button>
    <button class="menu-btn" onclick="location.href='contact.html'">üì© Contact Us</button>
    <button class="menu-btn upgrade-access-btn" onclick="window.location.href='premium.html'">üîì Unlock All Categories</button>
    <button class="menu-btn menu-close" id="closeMenu">Close</button>
  </div>
</div>

<!-- Upload Container -->
<main class="upload-container">
  <h1>Join the Battle</h1>
  <p class="subtitle">Sign up to enter the arena!</p>

  <div class="oauth-buttons">
    <!-- TikTok OAuth Button -->
    <button class="oauth-btn tiktok-btn" onclick="window.location.href='https://auth.geo-ranks.com/api/tiktok/auth'">
      <img src="assets/tik-tok.png" alt="TikTok" />
      Sign in with TikTok
    </button>

    <!-- Instagram Manual Signup Button -->
    <button class="oauth-btn instagram-btn" id="instagramBtn">
      <img src="assets/instagram.png" alt="Instagram" />
      Sign up with Instagram
    </button>
  </div>

  <!-- Instagram Manual Form -->
  <div class="instagram-form" id="instagramForm">
    <div class="form-header">
      <h3>üì∏ Instagram Signup</h3>
      <button class="close-form" id="closeForm">√ó</button>
    </div>

    <form id="manualSignupForm">
      <div class="form-group">
        <label for="username">Instagram Username</label>
        <input 
          type="text" 
          id="username" 
          name="username" 
          placeholder="@yourhandle" 
          required 
          maxlength="30"
        />
      </div>

      <div class="form-group">
        <label>Profile Picture</label>
        <div class="image-upload" id="imageUpload">
          <input 
            type="file" 
            id="imageInput" 
            name="image" 
            accept="image/*" 
            style="display: none;" 
            required
          />
          <div class="upload-area" id="uploadArea">
            <div class="upload-icon">üì∑</div>
            <div class="upload-text">Click to upload your photo</div>
          </div>
          <img id="imagePreview" class="image-preview" alt="Preview" />
        </div>
      </div>

      <button type="submit" class="submit-btn" id="submitBtn">
        Join Battle Royale
      </button>
    </form>

    <div class="success-message" id="successMessage">
      ‚úÖ Successfully signed up! Welcome to the battle!
    </div>
    <div class="error-message" id="errorMessage">
      ‚ùå Error: Please try again
    </div>
  </div>
</main>

<footer class="home-footer">
  <div class="footer-socials">
    <div class="icon-row">
      <a href="https://www.instagram.com/geo_ranks/" target="_blank" rel="noopener">
        <img src="assets/instagram.png" alt="Instagram" />
      </a>
      <div class="divider"></div>
      <a href="https://www.tiktok.com/@georanks" target="_blank" rel="noopener">
        <img src="assets/tik-tok.png" alt="TikTok" />
      </a>
      <div class="divider"></div>
      <a href="https://www.youtube.com/channel/UC8jrsBpCn09u0mHQle_O3Rw" target="_blank" rel="noopener">
        <img src="assets/youtube.png" alt="YouTube" />
      </a>
      <div class="divider"></div>
      <a href="https://x.com/Kieroncroo66687" target="_blank" rel="noopener">
        <img src="assets/x.png" alt="X" />
      </a>
    </div>
    <p>¬© 2025 GeoRanks</p>
  </div>
</footer>

<script>
  // Menu toggle
  const menuToggle = document.getElementById("menuToggle");
  const menuOverlay = document.getElementById("menuOverlay");
  const closeButton = document.getElementById("closeMenu");

  menuToggle?.addEventListener("click", () => menuOverlay.classList.add("active"));
  closeButton?.addEventListener("click", () => menuOverlay.classList.remove("active"));
  menuOverlay.addEventListener("click", (e) => {
    if (e.target === menuOverlay) menuOverlay.classList.remove("active");
  });

  // Instagram form toggle
  const instagramBtn = document.getElementById("instagramBtn");
  const instagramForm = document.getElementById("instagramForm");
  const closeForm = document.getElementById("closeForm");

  instagramBtn.addEventListener("click", () => {
    instagramForm.classList.add("active");
  });

  closeForm.addEventListener("click", () => {
    instagramForm.classList.remove("active");
  });

  // Image upload
  const imageUpload = document.getElementById("imageUpload");
  const imageInput = document.getElementById("imageInput");
  const uploadArea = document.getElementById("uploadArea");
  const imagePreview = document.getElementById("imagePreview");

  imageUpload.addEventListener("click", () => {
    imageInput.click();
  });

  imageInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        imagePreview.src = e.target.result;
        imagePreview.classList.add("active");
        uploadArea.classList.add("has-image");
        uploadArea.innerHTML = "";
        uploadArea.appendChild(imagePreview);
      };
      reader.readAsDataURL(file);
    }
  });

  // Form submission
  const manualSignupForm = document.getElementById("manualSignupForm");
  const submitBtn = document.getElementById("submitBtn");
  const successMessage = document.getElementById("successMessage");
  const errorMessage = document.getElementById("errorMessage");

  manualSignupForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    // Reset messages
    successMessage.classList.remove("active");
    errorMessage.classList.remove("active");

    // Disable button
    submitBtn.disabled = true;
    submitBtn.textContent = "Joining...";

    try {
      const formData = new FormData(manualSignupForm);

      const response = await fetch("https://auth.geo-ranks.com/api/instagram/manual-signup", {
        method: "POST",
        body: formData,
      });

      const data = await response.json();

      if (response.ok && data.success) {
        successMessage.textContent = `‚úÖ Welcome ${data.user.username}! You're in the battle!`;
        successMessage.classList.add("active");
        manualSignupForm.reset();
        imagePreview.classList.remove("active");
        uploadArea.classList.remove("has-image");
        uploadArea.innerHTML = `
          <div class="upload-icon">üì∑</div>
          <div class="upload-text">Click to upload your photo</div>
        `;

        // Close form after 2 seconds
        setTimeout(() => {
          instagramForm.classList.remove("active");
        }, 2000);
      } else {
        throw new Error(data.error || "Signup failed");
      }
    } catch (err) {
      errorMessage.textContent = `‚ùå ${err.message}`;
      errorMessage.classList.add("active");
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = "Join Battle Royale";
    }
  });
</script>

</body>
</html>