<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GeoRanks - Test Your World Knowledge</title>
  <link rel="icon" href="assets/favicon.png" type="image/png">
  
  <!-- ========================================
       üåç SOCIAL MEDIA META TAGS
       ======================================== -->
  
  <!-- Primary Meta Tags -->
  <meta name="title" content="GeoRanks - Test Your World Knowledge">
  <meta name="description" content="Challenge yourself with fun geography ranking games! Rank countries by population, GDP, landmarks, and more. Play daily challenges and compete on the leaderboard.">
  
  <!-- Open Graph / Facebook / WhatsApp / Instagram -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://geo-ranks.com/">
  <meta property="og:title" content="GeoRanks - Test Your World Knowledge">
  <meta property="og:description" content="Challenge yourself with fun geography ranking games! Rank countries by population, GDP, landmarks, and more. Play daily challenges and compete on the leaderboard.">
  <meta property="og:image" content="https://geo-ranks.com/assets/preview.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="GeoRanks - Geography Ranking Game">
  <meta property="og:site_name" content="GeoRanks">
  
  <!-- Twitter / X -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://geo-ranks.com/">
  <meta property="twitter:title" content="GeoRanks - Test Your World Knowledge">
  <meta property="twitter:description" content="Challenge yourself with fun geography ranking games! Rank countries by population, GDP, landmarks, and more. Play daily challenges and compete on the leaderboard.">
  <meta property="twitter:image" content="https://geo-ranks.com/assets/preview.jpg">
  
  <!-- ======================================== -->
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/game-modes.css" />
  <link rel="stylesheet" href="css/mode-selector.css" />
  <link rel="stylesheet" href="css/page.css">
  
  <style>
    /* ========================================
       BATTLE ROYALE BANNER
    ======================================== */
    .battle-banner {
      background: linear-gradient(135deg, #0d315a 0%, #1a4d7a 100%);
      color: white;
      padding: 14px 20px;
      text-align: center;
      font-family: 'Poppins', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      position: fixed;
      top: 64px; /* Exactly header height - no gap! */
      left: 0;
      width: 100%;
      z-index: 999; /* Just below header (which is 1000) */
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }
    
    .battle-banner:hover {
      background: linear-gradient(135deg, #0a2847 0%, #163d63 100%);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    }
    
    .battle-banner:active {
      transform: scale(0.99);
    }
    
    .battle-banner-text {
      font-size: 1rem;
      font-weight: 600;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .battle-banner-emoji {
      font-size: 1.2rem;
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.1);
      }
    }
    
    /* Adjust hero section to account for header + banner */
    .hero-section {
      margin-top: 90px !important; /* Reduced from 110px - smaller gap between banner and logo */
    }
    
    @media (max-width: 768px) {
      .battle-banner {
        padding: 12px 16px;
        top: 64px;
      }
      
      .battle-banner-text {
        font-size: 0.9rem;
      }
      
      .hero-section {
        margin-top: 85px !important; /* Reduced from 100px for mobile */
      }
    }
    
    /* ========================================
       HEADER USERNAME/SIGN-IN TEXT
    ======================================== */
    .sign-in-text {
      font-weight: 600;
      color: #0d315a;
      font-size: 1.1rem;
      cursor: pointer;
      margin-left: 1.2rem;
      text-decoration: none;
      transition: opacity 0.2s ease;
    }

    .sign-in-text:hover {
      opacity: 0.8;
    }
    
    /* ========================================
       HERO SECTION
    ======================================== */
    .hero-section {
      position: relative;
      padding: 80px 20px 40px; /* Reduced top padding from 120px to 80px */
      text-align: center;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      animation: fadeInUp 1s ease-out;
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
    }

    .hero-logo {
      max-width: 500px;
      width: 100%;
      height: auto;
      display: block;
      margin: 0 auto 1rem;
    }

    .hero-subtitle {
      font-size: clamp(1rem, 3vw, 1.5rem);
      color: #0d315a;
      margin-bottom: 2rem;
      font-weight: 500;
      opacity: 0.85;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ========================================
       CATEGORIES SECTION
    ======================================== */
    .categories-flow {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px 20px 60px;
      position: relative;
    }

    .categories-grid-new {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
      position: relative;
      margin-bottom: 60px;
    }

    .category-item {
      position: relative;
      opacity: 0;
      transform: translateY(50px) scale(0.9);
      animation: stompIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      transition: transform 0.3s ease;
    }

    .category-item:nth-child(1) { animation-delay: 0.15s; }
    .category-item:nth-child(2) { animation-delay: 0.30s; }
    .category-item:nth-child(3) { animation-delay: 0.45s; }
    .category-item:nth-child(4) { animation-delay: 0.60s; }
    .category-item:nth-child(5) { animation-delay: 0.75s; }
    .category-item:nth-child(6) { animation-delay: 0.90s; }

    @keyframes stompIn {
      0% {
        opacity: 0;
        transform: translateY(50px) scale(0.9);
      }
      60% {
        transform: translateY(-5px) scale(1.02);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .category-card-new {
      position: relative;
      height: 280px;
      border-radius: 24px;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background: #000;
      isolation: isolate;
      -webkit-mask-image: -webkit-radial-gradient(white, black);
      mask-image: radial-gradient(white, black);
      transform: translateZ(0);
      will-change: transform;
    }

    .category-card-new::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 24px;
      pointer-events: none;
      z-index: 10;
    }

    .category-card-new:hover {
      transform: translate3d(0, -8px, 0);
      box-shadow: 0 16px 64px rgba(0,0,0,0.4);
    }

    .category-bg {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      filter: brightness(0.7);
    }

    .category-card-new:hover .category-bg {
      transform: scale(1.1);
      filter: brightness(0.85);
    }

    .category-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%);
      mix-blend-mode: multiply;
      transition: opacity 0.4s ease;
    }

    .category-card-new:hover .category-overlay {
      opacity: 0.7;
    }

    .category-content {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 32px;
      z-index: 2;
    }

    .category-emoji {
      font-size: 3.5rem;
      margin-bottom: 12px;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .category-card-new:hover .category-emoji {
      transform: scale(1.15) rotate(5deg);
    }

    .category-name {
      font-size: 1.8rem;
      font-weight: 700;
      color: white;
      margin-bottom: 8px;
      text-shadow: 0 2px 16px rgba(0,0,0,0.6);
      transition: transform 0.3s ease;
    }

    .category-card-new:hover .category-name {
      transform: translateX(8px);
    }

    .category-play-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 12px;
      color: white;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      width: fit-content;
      opacity: 0;
      transform: translateY(10px);
    }

    .category-card-new:hover .category-play-btn {
      opacity: 1;
      transform: translateY(0);
      background: rgba(255,255,255,0.25);
      border-color: rgba(255,255,255,0.5);
    }

    /* ========================================
       VIEW ALL CATEGORIES BUTTON
    ======================================== */
    .view-all-btn-container {
      text-align: center;
      margin: 40px auto 60px;
      opacity: 0;
      animation: fadeInButton 0.6s ease-out forwards;
      animation-delay: 1.5s;
    }

    @keyframes fadeInButton {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .view-all-btn {
      display: inline-block;
      padding: 18px 48px;
      font-size: 1.2rem;
      font-weight: 700;
      color: white;
      background: linear-gradient(135deg, #ff9770 0%, #ff6f61 100%);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 24px rgba(255, 151, 112, 0.4);
      text-decoration: none;
      font-family: 'Poppins', sans-serif;
    }

    .view-all-btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(255, 151, 112, 0.5);
      background: linear-gradient(135deg, #ff8560 0%, #ff5f51 100%);
    }

    .view-all-btn:active {
      transform: translateY(-2px);
    }

    /* ========================================
       FOOTER
    ======================================== */

    .footer-links {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-top: 15px;
    }

    .footer-links a {
      color: rgba(221, 221, 221, 0.79);
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.3s ease;
    }

    .footer-links a:hover {
      color: #0e2c50;
    }

    .footer-links span {
      color: rgba(221, 221, 221, 0.79);
    }

    /* ========================================
       MOBILE RESPONSIVE
    ======================================== */
    @media (max-width: 768px) {
      .hero-logo {
        max-width: 420px;
      }

      .categories-grid-new {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .view-all-btn {
        padding: 16px 40px;
        font-size: 1.1rem;
      }

      .home-footer {
        padding: 30px 15px;
      }

      .icon-row {
        gap: 15px;
      }

      .icon-row img {
        width: 35px;
        height: 35px;
      }
    }

    @media (max-width: 480px) {
      .hero-logo {
        max-width: 350px;
      }

      .hero-section {
        padding: 100px 16px 30px;
      }

      .hero-subtitle {
      margin-bottom: -1rem;
    
    }

      .category-card-new {
        height: 240px;
      }

      .icon-row {
        gap: 10px;
      }

      .icon-row img {
        width: 30px;
        height: 30px;
      }
    }
  </style>
</head>
<body>

<!-- ========== HEADER ========== -->
<header class="home-glass-header">
  <a href="auth.html" id="signInText" class="sign-in-text">Loading...</a>
  <div class="menu-icon" id="menuToggle">
    <span></span>
    <span></span>
    <span></span>
  </div>
</header>

<!-- ========== BATTLE ROYALE BANNER ========== -->
<div class="battle-banner" onclick="window.location.href='upload.html'">
  <p class="battle-banner-text">
    <span class="battle-banner-emoji">‚öîÔ∏è</span>
    Join the Battle Royale Arena!
    <span class="battle-banner-emoji">üèÜ</span>
  </p>
</div>

<!-- ========== HAMBURGER MENU ========== -->
<div class="menu-overlay" id="menuOverlay">
  <div class="menu-panel">
    <h2>Menu</h2>
    
    <button class="menu-btn menu-daily-challenge" onclick="window.location.href='daily-challenge.html'" id="dailyChallengeMenuBtn">
      <div class="daily-bg" id="dailyChallengeBg"></div>
      <div class="daily-overlay"></div>
      <div class="daily-content">
        <h3 class="daily-title">üìÖ Daily Challenge</h3>
        <span class="daily-category" id="dailyChallengeCategory">Loading...</span>
      </div>
    </button>
    
    <button class="menu-btn" onclick="window.location.href='categories.html'">üéÆ Categories</button>
    <button class="menu-btn menu-btn-account" onclick="window.location.href='account.html'">üë§ Account</button>
    <button class="menu-btn" onclick="window.location.href='leaderboard.html'">üèÜ Leaderboard</button>
    <button class="menu-btn" onclick="window.location.href='stats.html'">üìä My Stats</button>
    <button class="menu-btn" onclick="window.location.href='how-to-play.html'">üí° How to Play</button>
    <button class="menu-btn" onclick="location.href='feedback.html'">üí¨ Feedback</button>
    <button class="menu-btn" onclick="location.href='contact.html'">üì© Contact Us</button>
    <button class="menu-btn upgrade-access-btn" onclick="window.location.href='premium.html'">üîì Unlock All Categories</button>
   <button class="menu-close-x" id="closeMenu">√ó</button>
  </div>
</div>

<!-- ========== HERO SECTION ========== -->
<section class="hero-section">
  <div class="hero-content">
    <img src="assets/logo.png" class="hero-logo" alt="GeoRanks" />
    <p class="hero-subtitle">Test Your World Ranking Knowledge! üåç</p>
  </div>
</section>

<!-- ========== CATEGORIES SECTION ========== -->
<div class="categories-flow">
  <div class="categories-grid-new" id="categoriesContainer"></div>
  
  <div class="view-all-btn-container">
    <a href="categories.html" class="view-all-btn">View All Categories</a>
  </div>
</div>

<!-- ========== FOOTER ========== -->
<footer class="home-footer">
  <div class="footer-socials">
    <div class="icon-row">
      <a href="https://www.instagram.com/geo_ranks/" target="_blank" rel="noopener">
        <img src="assets/instagram.png" alt="Instagram" />
      </a>
      <div class="divider"></div>
      <a href="https://www.tiktok.com/@georanks" target="_blank" rel="noopener">
        <img src="assets/tik-tok.png" alt="TikTok" />
      </a>
      <div class="divider"></div>
      <a href="https://www.youtube.com/channel/UC8jrsBpCn09u0mHQle_O3Rw" target="_blank" rel="noopener">
        <img src="assets/youtube.png" alt="YouTube" />
      </a>
      <div class="divider"></div>
      <a href="https://x.com/Kieroncroo66687" target="_blank" rel="noopener">
        <img src="assets/x.png" alt="X" />
      </a>
      <div class="divider"></div>
      <a href="https://www.threads.net/@geo_ranks" target="_blank" rel="noopener">
        <img src="assets/threads.png" alt="Threads" />
      </a>
      <div class="divider"></div>
      <a href="https://www.buymeacoffee.com/" target="_blank" rel="noopener">
        <img src="assets/buymeacoffee.png" alt="Coffee" />
      </a>
    </div>
    <p>¬© 2026 GeoRanks</p>
    <div class="footer-links">
      <a href="terms.html">Terms of Service</a>
      <span>‚Ä¢</span>
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </div>
</footer>

<!-- ========== JAVASCRIPT ========== -->
<script type="module">
  import { supabase } from './js/supabase-client.js';
  import { openModeSelector as originalOpenModeSelector } from './js/mode-selector.js';

  // First 9 free categories
  const freeCategories = [
    { category: "population", display: "Population", emoji: "üë•", image: "population.jpg" },
    { category: "gdp", display: "GDP Per Capita", emoji: "üíµ", image: "gdp.jpg" },
    { category: "altitude", display: "Highest Altitude", emoji: "üèîÔ∏è", image: "altitude.jpg" },
    { category: "forest", display: "Forest Cover", emoji: "üå≤", image: "forest.jpg" },
    { category: "olympic", display: "Olympic Medals", emoji: "ü•á", image: "olympic.jpg" },
    { category: "landmass", display: "Land Mass", emoji: "üåç", image: "landmass.jpg" }
  ];

  // Store scroll position for mode selector
  let modeSelectorScrollPosition = 0;

  // Wrap openModeSelector to handle scroll position
  window.openModeSelector = function(category, display, emoji) {
    modeSelectorScrollPosition = window.pageYOffset;
    document.body.style.top = `-${modeSelectorScrollPosition}px`;
    originalOpenModeSelector(category, display, emoji);
  };

  // Restore scroll when mode selector closes
  window.addEventListener('closeModeSelectorCustom', () => {
    document.body.style.top = '';
    window.scrollTo(0, modeSelectorScrollPosition);
  });

  // Render categories
  function renderCategories() {
    const container = document.getElementById('categoriesContainer');
    
    container.innerHTML = freeCategories.map(cat => `
      <div class="category-item">
        <div class="category-card-new" onclick="openModeSelector('${cat.category}', '${cat.display}', '${cat.emoji}')">
          <div class="category-bg" style="background-image: url('images/categories/${cat.image}');"></div>
          <div class="category-overlay"></div>
          <div class="category-content">
            <div class="category-emoji">${cat.emoji}</div>
            <div class="category-name">${cat.display}</div>
            <div class="category-play-btn">
              <span>Play</span>
              <span>‚ñ∂</span>
            </div>
          </div>
        </div>
      </div>
    `).join('');
  }

  // Initialize
  renderCategories();

  // Menu toggle with scroll lock
  const menuToggle = document.getElementById('menuToggle');
  const menuOverlay = document.getElementById('menuOverlay');
  const closeMenu = document.getElementById('closeMenu');
  let scrollPosition = 0;

  menuToggle?.addEventListener('click', () => {
    scrollPosition = window.pageYOffset;
    document.body.classList.add('menu-open');
    document.body.style.top = `-${scrollPosition}px`;
    menuOverlay.classList.add('active');
  });

  function closeMenuHandler() {
    document.body.classList.remove('menu-open');
    document.body.style.top = '';
    window.scrollTo(0, scrollPosition);
    menuOverlay.classList.remove('active');
  }

  closeMenu?.addEventListener('click', closeMenuHandler);

  menuOverlay?.addEventListener('click', (e) => {
    if (e.target === menuOverlay) {
      closeMenuHandler();
    }
  });
</script>

<!-- Sign-In Text Update -->
<script type="module">
  import { supabase } from './js/supabase-client.js';

  const signInText = document.getElementById('signInText');
  signInText.textContent = "Loading...";
  signInText.style.opacity = "0.6";

  const { data: { session } } = await supabase.auth.getSession();

  if (session && session.user) {
    const userMeta = session.user.user_metadata;
    
    // Try to fetch username from the users table in database
    let displayName = userMeta.full_name || userMeta.username;
    
    // If no username in metadata, try fetching from users table
    if (!displayName) {
      try {
        const { data: userData, error } = await supabase
          .from('users')
          .select('username')
          .eq('id', session.user.id)
          .single();
        
        if (!error && userData && userData.username) {
          displayName = userData.username;
        }
      } catch (err) {
        console.log('Could not fetch username from database');
      }
    }
    
    // Final fallback to "Account" (no email shown)
    signInText.textContent = displayName || "Account";
    signInText.href = "account.html";
  } else {
    signInText.textContent = "Sign In | Create Account";
    signInText.href = "auth.html";
  }
  signInText.style.opacity = "1";
</script>

<!-- Account/Premium Button Removal -->
<script type="module">
  import { supabase } from './js/supabase-client.js';
  (async () => {
    const { data: { session } } = await supabase.auth.getSession();
    if (session?.user) {
      const { data: profile } = await supabase.from('users').select('is_premium').eq('id', session.user.id).single();
      if (profile?.is_premium) document.querySelectorAll('.upgrade-access-btn').forEach(btn => btn.remove());
    }
    if (!session?.user) document.querySelectorAll('.menu-btn-account').forEach(btn => btn.remove());
  })();
</script>

<!-- Daily Challenge Menu Button -->
<script type="module">
  import { getTodaysDailyChallenge, modeDisplayNames, categoryDisplayNames, categoryEmojis } from './js/daily-challenge.js';
  document.addEventListener('DOMContentLoaded', () => {
    const categorySpan = document.getElementById('dailyChallengeCategory');
    const bg = document.getElementById('dailyChallengeBg');
    const today = getTodaysDailyChallenge();
    if (today && categorySpan && bg) {
      const modeName = modeDisplayNames[today.mode] || today.mode.toUpperCase();
      const categoryName = categoryDisplayNames[today.category] || today.category;
      const emoji = categoryEmojis[today.category] || '';
      categorySpan.textContent = `${modeName}: ${categoryName} ${emoji}`;
      bg.style.backgroundImage = `url('images/categories/${today.category}.jpg')`;
    }
  });
</script>

</body>
</html>