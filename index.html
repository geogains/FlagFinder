<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Discover Categories - GeoRanks</title>
  <link rel="icon" href="assets/favicon.png" type="image/png">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/game-modes.css" />
  <link rel="stylesheet" href="css/home.css" />
  <link rel="stylesheet" href="css/mode-selector.css" />
  
  <style>

    body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100%;
  background: linear-gradient(135deg, #abefcf, #38bdf8);
  z-index: -1;
  pointer-events: none;
}
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #a7f3d0 0%, #38bdf8 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ========== HERO SECTION ========== */
    .hero-section {
      position: relative;
      height: 60vh;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 120px 20px 60px;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      animation: fadeInUp 1s ease-out;
      width: 100%; /* Ensure full width */
      max-width: 1400px; /* Match the categories-flow max-width */
      margin: 0 auto; /* Center it */
    }

    .hero-title {
      font-size: clamp(2.5rem, 8vw, 5rem);
      font-weight: 800;
      color: #0d315a;
      margin-bottom: 1rem;
      text-shadow: 0 2px 8px rgba(13, 49, 90, 0.15);
      letter-spacing: -1px;
    }

    .hero-subtitle {
      font-size: clamp(1rem, 3vw, 1.5rem);
      color: #0d315a;
      margin-bottom: 2rem;
      font-weight: 500;
      opacity: 0.85;
    }

    .search-bar-hero {
      max-width: 600px;
      margin: 0 auto;
      position: relative;
      margin-top: 2.5rem; /* Add spacing from subtitle */
    }

    .search-bar-hero input {
      width: 100%;
      padding: 18px 24px;
      font-size: 1.1rem;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50px;
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      cursor: pointer;
    }

    .search-bar-hero input:focus {
      outline: none;
      border-color: rgba(255,255,255,0.6);
      transform: translateY(-2px);
      box-shadow: 0 12px 48px rgba(0,0,0,0.2);
    }

    /* ========== SEARCH DROPDOWN ========== */
    .search-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      margin-top: 8px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 12px 48px rgba(0,0,0,0.2);
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
    }

    .search-dropdown.active {
      display: block;
      animation: dropdownSlide 0.3s ease-out;
    }

    @keyframes dropdownSlide {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .search-dropdown-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 20px;
      cursor: pointer;
      transition: background 0.2s ease;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .search-dropdown-item:last-child {
      border-bottom: none;
    }

    .search-dropdown-item:hover {
      background: rgba(102,126,234,0.08);
    }

    .search-dropdown-item img {
      width: 60px;
      height: 40px;
      border-radius: 8px;
      object-fit: cover;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .search-dropdown-text {
      flex: 1;
      font-weight: 500;
      color: #333;
      font-size: 1rem;
    }

    .search-dropdown::-webkit-scrollbar {
      width: 8px;
    }

    .search-dropdown::-webkit-scrollbar-track {
      background: rgba(0,0,0,0.05);
      border-radius: 10px;
    }

    .search-dropdown::-webkit-scrollbar-thumb {
      background: rgba(102,126,234,0.3);
      border-radius: 10px;
    }

    .search-dropdown::-webkit-scrollbar-thumb:hover {
      background: rgba(102,126,234,0.5);
    }

    .no-results {
      padding: 24px;
      text-align: center;
      color: #666;
      font-size: 1rem;
    }

    /* ========== CATEGORIES FLOW ========== */
    .categories-flow {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px 100px;
      position: relative;
      transition: padding-top 0.3s ease;
    }

    /* Reduce top padding on subpages (pages 2, 3, 4) to close gap */
    .categories-flow.no-hero {
      padding-top: 20px; /* Reduced from 120px */
    }

    .category-item {
      position: relative;
      opacity: 0;
      transform: translateY(50px) scale(0.9);
      animation: stompIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      transition: transform 0.3s ease;
    }

    .category-item:nth-child(1) { animation-delay: 0.15s; }
    .category-item:nth-child(2) { animation-delay: 0.30s; }
    .category-item:nth-child(3) { animation-delay: 0.45s; }
    .category-item:nth-child(4) { animation-delay: 0.60s; }
    .category-item:nth-child(5) { animation-delay: 0.75s; }
    .category-item:nth-child(6) { animation-delay: 0.90s; }
    .category-item:nth-child(7) { animation-delay: 1.05s; }
    .category-item:nth-child(8) { animation-delay: 1.20s; }
    .category-item:nth-child(9) { animation-delay: 1.35s; }
    .category-item:nth-child(10) { animation-delay: 1.50s; }
    .category-item:nth-child(11) { animation-delay: 1.65s; }
    .category-item:nth-child(12) { animation-delay: 1.80s; }

    .category-card-new {
      position: relative;
      height: 280px;
      border-radius: 24px;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background: #000;
      isolation: isolate;
      -webkit-mask-image: -webkit-radial-gradient(white, black);
      mask-image: radial-gradient(white, black);
      transform: translateZ(0);
      will-change: transform;
    }

    .category-card-new::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 24px;
      pointer-events: none;
      z-index: 10;
    }

    .category-card-new:hover {
      transform: translate3d(0, -8px, 0);
      box-shadow: 0 16px 64px rgba(0,0,0,0.4);
    }

    .category-bg {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      filter: brightness(0.7);
    }

    .category-card-new:hover .category-bg {
      transform: scale(1.1);
      filter: brightness(0.85);
    }

    .category-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(102,126,234,0.4) 0%, rgba(118,75,162,0.6) 100%);
      mix-blend-mode: multiply;
      transition: opacity 0.4s ease;
    }

    .category-card-new:hover .category-overlay {
      opacity: 0.7;
    }

    .category-content {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 32px;
      z-index: 2;
    }

    .category-emoji {
      font-size: 3.5rem;
      margin-bottom: 12px;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .category-card-new:hover .category-emoji {
      transform: scale(1.15) rotate(5deg);
    }

    .category-name {
      font-size: 1.8rem;
      font-weight: 700;
      color: white;
      margin-bottom: 8px;
      text-shadow: 0 2px 16px rgba(0,0,0,0.6);
      transition: transform 0.3s ease;
    }

    .category-card-new:hover .category-name {
      transform: translateX(8px);
    }

    .category-play-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 12px;
      color: white;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      width: fit-content;
      opacity: 0;
      transform: translateY(10px);
    }

    .category-card-new:hover .category-play-btn {
      opacity: 1;
      transform: translateY(0);
      background: rgba(255,255,255,0.25);
      border-color: rgba(255,255,255,0.5);
    }

    /* LOCKED CATEGORIES */
    .category-card-new.locked {
      cursor: pointer;
    }

    .category-card-new.locked .category-bg {
      filter: brightness(0.4) grayscale(0.5);
    }

    .lock-badge {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255,215,0,0.95);
      backdrop-filter: blur(10px);
      padding: 8px 16px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      font-size: 0.9rem;
      color: #000;
      box-shadow: 0 4px 16px rgba(255,215,0,0.4);
      z-index: 3;
    }

    /* ========== GRID LAYOUT ========== */
    .categories-grid-new {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
      position: relative;
      padding-bottom: 60px;
    }

    /* Divider below categories grid */
    .categories-grid-new::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 1200px;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(13, 49, 90, 0.15), transparent);
      border-radius: 2px;
      opacity: 0;
      animation: fadeInDivider 0.6s ease-out forwards;
      animation-delay: 1.95s; /* Fades in after 9th card (last card at 1.65s + 0.3s) */
    }

    @keyframes fadeInDivider {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    /* ========== ANIMATIONS ========== */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes stompIn {
      0% {
        opacity: 0;
        transform: translateY(50px) scale(0.9);
      }
      50% {
        transform: translateY(-10px) scale(1.05);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes slideUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInPagination {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 768px) {
      .hero-section {
        height: 50vh;
        min-height: 350px;
        padding-top: 100px;
      }

      /* Adjust search bar spacing on mobile */
      .search-bar-hero {
        margin-top: 2rem;
      }

      /* Subpage adjustments - reduce gap significantly */
      body.category-subpage .hero-section {
        padding: 80px 20px 15px;
      }

      body.category-subpage .search-bar-hero {
        max-width: 600px;
      }

      .categories-flow {
        padding: 40px 12px 0px; /* Reduced side padding from 20px to 12px for wider cards */
      }

      /* Further reduce top padding on subpages */
      .categories-flow.no-hero {
        padding-top: 15px;
      }

      .categories-grid-new {
        grid-template-columns: 1fr;
        gap: 8px; /* Reduced from 12px */
      }

      .category-card-new {
        height: 260px; /* Reduced from 280px */
      }

      .category-content {
        padding: 28px;
      }

      .category-emoji {
        font-size: 3rem;
      }

      .category-name {
        font-size: 1.6rem;
      }

      .category-play-btn {
        padding: 12px 24px;
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      .hero-section {
        padding-top: 90px;
        padding-left: 16px;
        padding-right: 16px;
      }

      /* Reduce search bar margin on very small screens */
      .search-bar-hero {
        margin-top: 1.5rem;
      }

      .search-bar-hero input {
        padding: 14px 20px;
        font-size: 1rem;
      }

      /* Subpage mobile adjustments - minimize gap */
      body.category-subpage .hero-section {
        padding: 75px 16px 10px;
      }

      body.category-subpage .search-bar-hero {
        max-width: 100%;
      }

      .categories-flow {
        padding: 40px 10px 100px; /* Even less side padding on small phones */
      }

      /* Further reduce top padding on subpages for mobile */
      .categories-flow.no-hero {
        padding-top: 10px;
      }

      .categories-grid-new {
        gap: 6px; /* Reduced from 10px */
      }

      .category-card-new {
        height: 240px; /* Reduced from 260px */
      }

      .category-emoji {
        font-size: 2.7rem; /* Increased from 2.5rem */
      }

      .category-name {
        font-size: 1.4rem; /* Increased from 1.3rem */
      }
    }

    /* ========== PAGINATION CONTROLS ========== */
    .pagination-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin: 60px 0 10px;
      flex-wrap: nowrap; /* Changed from wrap to nowrap */
      overflow-x: auto; /* Allow horizontal scroll if needed */
      padding: 0 20px;
      opacity: 0;
      animation: fadeInPagination 0.6s ease-out forwards;
      animation-delay: 2.1s;
      position: relative;
    }

    .page-btn {
      min-width: 50px;
      padding: 14px 24px;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(0,0,0,0.1);
      border-radius: 12px;
      color: #333;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      flex-shrink: 0; /* Prevent buttons from shrinking */
    }

    .page-btn:hover:not(.active):not(:disabled) {
      background: white;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .page-btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: transparent;
      box-shadow: 0 6px 24px rgba(102,126,234,0.4);
    }

    .page-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .page-arrow {
      font-size: 1.1rem;
    }

    /* Mobile pagination adjustments */
    @media (max-width: 768px) {
      .pagination-controls {
        gap: 8px;
        padding: 0 10px;
      }

      .page-btn {
        min-width: 40px;
        padding: 10px 16px;
        font-size: 0.9rem;
      }

      .page-arrow {
        font-size: 1rem;
        padding: 10px 12px;
      }
    }

    @media (max-width: 480px) {
      .pagination-controls {
        gap: 6px;
      }

      .page-btn {
        min-width: 35px;
        padding: 8px 12px;
        font-size: 0.85rem;
      }

      .page-arrow {
        font-size: 0.9rem;
        padding: 8px 10px;
      }
    }

    /* ========== PREMIUM HAMBURGER MENU ========== */
    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(13, 49, 90, 0.75);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      z-index: 9998;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .menu-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .menu-panel {
      position: fixed;
      top: 0;
      right: 0;
      width: 100%;
      max-width: 420px;
      height: 100vh; /* Fixed viewport height */
      max-height: 100vh; /* Ensure it doesn't exceed viewport */
      background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      box-shadow: -8px 0 40px rgba(0, 0, 0, 0.25);
      transform: translateX(100%);
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      overflow-y: auto;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      padding: 100px 32px 40px;
    }

    .menu-overlay.active .menu-panel {
      transform: translateX(0);
    }

    /* Prevent body scroll when menu is open */
    body.menu-open {
      overflow: hidden;
      height: 100vh;
    }

    .menu-panel h2 {
      font-size: 2rem;
      font-weight: 700;
      color: #0d315a;
      margin-bottom: 32px;
      letter-spacing: -0.5px;
      position: relative;
      padding-bottom: 16px;
    }

    .menu-panel h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
      border-radius: 2px;
    }

    .menu-btn {
      display: flex;
      align-items: center;
      gap: 16px;
      width: 100%;
      padding: 18px 24px;
      margin-bottom: 12px;
      background: white;
      border: 2px solid rgba(13, 49, 90, 0.08);
      border-radius: 16px;
      font-size: 1.05rem;
      font-weight: 600;
      color: #0d315a;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: 'Poppins', sans-serif;
      text-align: left;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      position: relative;
      overflow: hidden;
    }

    .menu-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .menu-btn:hover::before {
      left: 100%;
    }

    .menu-btn:hover {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
      border-color: rgba(102, 126, 234, 0.3);
      transform: translateX(4px);
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.15);
    }

    .menu-btn:active {
      transform: translateX(4px) scale(0.98);
    }

    .upgrade-access-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
      margin-top: 8px;
    }

    .upgrade-access-btn:hover {
      background: linear-gradient(135deg, #5568d3 0%, #653a8b 100%);
      transform: translateX(4px) translateY(-2px);
      box-shadow: 0 6px 28px rgba(102, 126, 234, 0.5);
    }

    .menu-close {
      margin-top: auto;
      background: rgba(13, 49, 90, 0.06);
      border-color: rgba(13, 49, 90, 0.12);
      color: #0d315a;
      font-weight: 500;
    }

    .menu-close:hover {
      background: rgba(13, 49, 90, 0.12);
      border-color: rgba(13, 49, 90, 0.2);
    }

    /* Scrollbar styling for menu */
    .menu-panel::-webkit-scrollbar {
      width: 8px;
    }

    .menu-panel::-webkit-scrollbar-track {
      background: rgba(13, 49, 90, 0.05);
      border-radius: 10px;
    }

    .menu-panel::-webkit-scrollbar-thumb {
      background: rgba(102, 126, 234, 0.3);
      border-radius: 10px;
    }

    .menu-panel::-webkit-scrollbar-thumb:hover {
      background: rgba(102, 126, 234, 0.5);
    }

    @media (max-width: 768px) {
      .menu-panel {
        max-width: 85%;
        padding: 80px 24px 32px;
      }

      .menu-panel h2 {
        font-size: 1.75rem;
        margin-bottom: 24px;
      }

      .menu-btn {
        padding: 16px 20px;
        font-size: 1rem;
        margin-bottom: 10px;
      }
    }

    @media (max-width: 480px) {
      .menu-panel {
        max-width: 90%;
        padding: 70px 20px 24px;
      }

      .menu-panel h2 {
        font-size: 1.5rem;
        margin-bottom: 20px;
      }

      .menu-btn {
        padding: 14px 18px;
        font-size: 0.95rem;
        gap: 12px;
      }

   /* When on page 2-4: hide hero-content but keep search bar */
.categories-flow.no-hero ~ .hero-section .hero-content {
  display: none;
}

.categories-flow.no-hero ~ .hero-section .search-bar-hero {
  display: block;
}

/* Optional: tighten vertical spacing on pages 2‚Äì4 */
.categories-flow.no-hero ~ .hero-section {
  height: auto;
  min-height: 0;
  padding: 40px 20px 20px;
}

    }
  </style>
</head>
<body>

<!-- üîí PREMIUM UPGRADE MODAL -->
<div id="premiumModal" class="premium-modal hidden">
  <div class="premium-window">
    <h2>Premium Feature <span class="lock">üîí</span></h2>
    <p>These categories are only available with <strong>GeoRanks Premium</strong>.</p>
    <button id="goPremiumBtn" class="premium-btn upgrade">Upgrade to Premium</button>
    <button id="closePremiumBtn" class="premium-btn cancel">Close</button>
  </div>
</div>

<!-- ========== HEADER ========== -->
<header class="home-glass-header">
  <a href="auth.html" id="signInText" class="sign-in-text">Loading...</a>
  <div class="menu-icon" id="menuToggle">
    <span></span>
    <span></span>
    <span></span>
  </div>
</header>


<!-- Hamburger Overlay Menu -->
<div class="menu-overlay" id="menuOverlay">
  <div class="menu-panel">
    <h2>Menu</h2>
    <button class="menu-btn menu-daily-challenge" onclick="window.location.href='daily-challenge.html'" id="dailyChallengeMenuBtn">
  <div class="daily-bg" id="dailyChallengeBg"></div>
  <div class="daily-overlay"></div>
  <div class="daily-content">
    <h3 class="daily-title">üìÖ Daily Challenge</h3>
    <span class="daily-category" id="dailyChallengeCategory">Loading...</span>
  </div>
</button>

    <button class="menu-btn menu-btn-account" onclick="window.location.href='account.html'">üë§ Account</button>
    <button class="menu-btn" onclick="window.location.href='leaderboard.html'">üèÜ Leaderboard</button>
    <button class="menu-btn" onclick="window.location.href='stats.html'">üìä My Stats</button>
    <button class="menu-btn" onclick="window.location.href='how-to-play.html'">üí° How to Play</button>
    <button class="menu-btn" onclick="location.href='feedback.html'">üí¨ Feedback</button>
    <button class="menu-btn" onclick="location.href='contact.html'">üì© Contact Us</button>
    <button class="menu-btn upgrade-access-btn" onclick="window.location.href='premium.html'">üîì Unlock All Categories</button>
    <button class="menu-btn menu-close" id="closeMenu">Close</button>
  </div>
</div>

<!-- ========== HERO SECTION ========== -->
<section class="hero-section">
  <div class="hero-content">
    <img src="assets/logo.png" class="hero-logo" alt="GeoRanks" />
    <p class="hero-subtitle">36 unique ways to test your world knowledge</p>
    <div class="search-bar-hero">
  <input type="text" id="categorySearchInput" placeholder="üîç Search categories..." />
  <div class="search-dropdown" id="searchDropdown"></div>
</div>
  </div>
</section>

<!-- ========== CATEGORIES SECTION ========== -->
<div class="categories-flow">
  <!-- ========== CATEGORIES GRID ========== -->
  <div class="categories-grid-new" id="categoriesGrid" data-filter="all">
    <!-- Categories will be rendered here -->
  </div>

  <!-- ========== PAGINATION ========== -->
  <div class="pagination-controls">
    <button class="page-btn page-arrow" id="prevPage" disabled>‚Üê Prev</button>
    <button class="page-btn active" data-page="1">1</button>
    <button class="page-btn" data-page="2">2</button>
    <button class="page-btn" data-page="3">3</button>
    <button class="page-btn" data-page="4">4</button>
    <button class="page-btn page-arrow" id="nextPage">Next ‚Üí</button>
  </div>
</div>

<footer class="home-footer">
  <div class="footer-socials">
    <div class="icon-row">
      <a href="https://www.instagram.com/geo_ranks/" target="_blank" rel="noopener">
        <img src="assets/instagram.png" alt="Instagram" />
      </a>
      <div class="divider"></div>
      <a href="https://www.tiktok.com/@georanks" target="_blank" rel="noopener">
        <img src="assets/tik-tok.png" alt="TikTok" />
      </a>
      <div class="divider"></div>
      <a href="https://www.youtube.com/channel/UC8jrsBpCn09u0mHQle_O3Rw" target="_blank" rel="noopener">
        <img src="assets/youtube.png" alt="YouTube" />
      </a>
      <div class="divider"></div>
      <a href="https://x.com/Kieroncroo66687" target="_blank" rel="noopener">
        <img src="assets/x.png" alt="X" />
      </a>
    </div>
    <p>¬© 2025 GeoRanks</p>
    <div class="footer-links">
      <a href="terms.html">Terms of Service</a>
      <span>‚Ä¢</span>
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </div>
</footer>


<script type="module">
  import { supabase } from './js/supabase-client.js';
  import { openModeSelector as originalOpenModeSelector } from './js/mode-selector.js';

  // Store scroll position for mode selector
  let modeSelectorScrollPosition = 0;

  // Wrap openModeSelector to handle scroll position
  window.openModeSelector = function(category, display, emoji) {
    // Store current scroll position
    modeSelectorScrollPosition = window.pageYOffset;
    
    // Call original function
    originalOpenModeSelector(category, display, emoji);
    
    // Wait for modal to render, then scroll to center it
    setTimeout(() => {
      const modal = document.querySelector('.mode-selector-modal');
      if (modal) {
        modal.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }, 100);
  };

  // Listen for mode selector close to restore scroll position
  document.addEventListener('click', (e) => {
    if (e.target.classList.contains('mode-selector-overlay') || 
        e.target.classList.contains('mode-selector-close') ||
        e.target.classList.contains('mode-cancel-btn')) {
      // Small delay to let modal close animation start
      setTimeout(() => {
        window.scrollTo({ top: modeSelectorScrollPosition, behavior: 'smooth' });
      }, 100);
    }
  });

  // All 36 categories data
  const allCategoriesData = [
    // FREE CATEGORIES (8)
    { category: "population", display: "Population", emoji: "üë•", premium: false, image: "population.jpg" },
    { category: "gdp", display: "GDP Per Capita", emoji: "üíµ", premium: false, image: "gdp.jpg" },
    { category: "altitude", display: "Highest Altitude", emoji: "üèîÔ∏è", premium: false, image: "altitude.jpg" },
    { category: "forest", display: "Forest Cover", emoji: "üå≤", premium: false, image: "forest.jpg" },
    { category: "olympic", display: "Olympic Medals", emoji: "ü•á", premium: false, image: "olympic.jpg" },
    { category: "landmass", display: "Land Mass", emoji: "üåç", premium: false, image: "landmass.jpg" },
    { category: "passport", display: "Passport Strength", emoji: "üõÇ", premium: false, image: "passport.jpg" },
    { category: "beer", display: "Beer Consumption", emoji: "üç∫", premium: false, image: "beer.jpg" },
    
    // PREMIUM CATEGORIES (28) - Alphabetically sorted
    { category: "bigmac", display: "BigMac Index", emoji: "üçî", premium: true, image: "bigmac.jpg" },
    { category: "carexports", display: "Car Exports", emoji: "üöó", premium: true, image: "carexports.jpg" },
    { category: "coastline", display: "Longest Coastline", emoji: "üèùÔ∏è", premium: true, image: "coastline.jpg" },
    { category: "crimerate", display: "Crime Rate", emoji: "üö®", premium: true, image: "crimerate.jpg" },
    { category: "cuisine", display: "Cuisine", emoji: "üçΩÔ∏è", premium: true, image: "cuisine.jpg" },
    { category: "density", display: "Population Density", emoji: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", premium: true, image: "density.jpg" },
    { category: "disasterrisk", display: "Natural Disasters", emoji: "üå™Ô∏è", premium: true, image: "disasterrisk.jpg" },
    { category: "flamingo", display: "Flamingos", emoji: "ü¶©", premium: true, image: "flamingo.jpg" },
    { category: "gm", display: "Chess Grandmasters", emoji: "‚ôüÔ∏è", premium: true, image: "gm.jpg" },
    { category: "happiness", display: "Happiness", emoji: "üòä", premium: true, image: "happiness.jpg" },
    { category: "lifeexpectancy", display: "Life Expectancy", emoji: "ü§ç", premium: true, image: "lifeexpectancy.jpg" },
    { category: "longestriver", display: "Longest River", emoji: "üåä", premium: true, image: "longestriver.jpg" },
    { category: "marriageage", display: "Marriage Age", emoji: "üíç", premium: true, image: "marriageage.jpg" },
    { category: "michelin", display: "Michelin Restaurants", emoji: "‚≠ê", premium: true, image: "michelin.jpg" },
    { category: "militarypersonel", display: "Military Personnel", emoji: "ü™ñ", premium: true, image: "militarypersonel.jpg" },
    { category: "millionaires", display: "Millionaires", emoji: "üí∞", premium: true, image: "millionaires.jpg" },
    { category: "nobelprize", display: "Nobel Prize Winners", emoji: "üïäÔ∏è", premium: true, image: "nobelprize.jpg" },
    { category: "poorestgdp", display: "Poorest Countries", emoji: "üìâ", premium: true, image: "poorestgdp.jpg" },
    { category: "precipitation", display: "Rainfall", emoji: "üåßÔ∏è", premium: true, image: "rainfall.jpg" },
    { category: "renewableenergy", display: "Renewable Energy", emoji: "‚ôªÔ∏è", premium: true, image: "renewableenergy.jpg" },
    { category: "rent", display: "Rent Prices", emoji: "üè†", premium: true, image: "rent.jpg" },
    { category: "sexratio", display: "Gender Ratio", emoji: "‚öñÔ∏è", premium: true, image: "sexratio.jpg" },
    { category: "tallestbuilding", display: "Tallest Building", emoji: "üèôÔ∏è", premium: true, image: "tallestbuilding.jpg" },
    { category: "temperature", display: "Highest Temperature", emoji: "üå°Ô∏è", premium: true, image: "hightemp.jpg" },
    { category: "tourism", display: "Tourist Visits", emoji: "‚úàÔ∏è", premium: true, image: "tourism.jpg" },
    { category: "university", display: "Most Universities", emoji: "üéì", premium: true, image: "university.jpg" },
    { category: "volcano", display: "Volcanoes", emoji: "üåã", premium: true, image: "volcano.jpg" },
    { category: "worldcup", display: "World Cup Trophies", emoji: "‚öΩ", premium: true, image: "worldcup.jpg" }
  ];

  let userIsPremium = false;
  let currentPage = 1;
  const ITEMS_PER_PAGE = 9; // 9 categories per page = 4 pages total (36 categories)

  // Check premium status
  async function checkPremiumStatus() {
    const { data: { session } } = await supabase.auth.getSession();
    
    if (session?.user) {
      const { data: profile } = await supabase
        .from('users')
        .select('is_premium')
        .eq('id', session.user.id)
        .single();
      
      userIsPremium = profile?.is_premium || false;
      
      if (userIsPremium) {
        document.querySelectorAll('.upgrade-access-btn').forEach(btn => btn.remove());
      }
    }
    
    if (!session?.user) {
      document.querySelectorAll('.menu-btn-account').forEach(btn => btn.remove());
    }
    
    renderCategories();
  }

  // Render categories with pagination
  function renderCategories() {
    const grid = document.getElementById('categoriesGrid');
    grid.innerHTML = '';

    // Show/hide hero section based on page
    const heroSection = document.querySelector('.hero-section');
    const categoriesFlow = document.querySelector('.categories-flow');
    
    if (heroSection) {
  if (currentPage === 1) {
    categoriesFlow?.classList.remove('no-hero');
  } else {
    categoriesFlow?.classList.add('no-hero');
  }
}

    const start = (currentPage - 1) * ITEMS_PER_PAGE;
    const end = start + ITEMS_PER_PAGE;
    const pageCategories = allCategoriesData.slice(start, end);

    pageCategories.forEach((cat, index) => {
      const isLocked = cat.premium && !userIsPremium;
      
      const item = document.createElement('div');
      item.className = `category-item ${cat.premium ? 'premium' : 'free'}`;
      item.style.setProperty('--index', index);
      
      item.innerHTML = `
        <div class="category-card-new ${isLocked ? 'locked' : ''}" 
             data-category="${cat.category}"
             data-display="${cat.display}"
             data-emoji="${cat.emoji}">
          <div class="category-bg" style="background-image: url('images/categories/${cat.image}');"></div>
          <div class="category-overlay"></div>
          ${isLocked ? '<div class="lock-badge">üîí Premium</div>' : ''}
          <div class="category-content">
            <div class="category-emoji">${cat.emoji}</div>
            <div class="category-name">${cat.display}</div>
            <div class="category-play-btn">Play Now ‚Üí</div>
          </div>
        </div>
      `;
      
      grid.appendChild(item);
    });

    // Add click handlers
    document.querySelectorAll('.category-card-new').forEach(card => {
      card.addEventListener('click', () => {
        if (card.classList.contains('locked')) {
          showPremiumModal();
        } else {
          const category = card.dataset.category;
          const display = card.dataset.display;
          const emoji = card.dataset.emoji;
          openModeSelector(category, display, emoji);
        }
      });
    });

    updatePagination();
  }

  // Update pagination buttons
  function updatePagination() {
    const totalPages = Math.ceil(allCategoriesData.length / ITEMS_PER_PAGE);
    
    document.querySelectorAll('.page-btn[data-page]').forEach(btn => {
      btn.classList.toggle('active', parseInt(btn.dataset.page) === currentPage);
    });

    const prevBtn = document.getElementById('prevPage');
    const nextBtn = document.getElementById('nextPage');
    
    prevBtn.disabled = currentPage === 1;
    nextBtn.disabled = currentPage === totalPages;
  }

  // Pagination handlers
  document.querySelectorAll('.page-btn[data-page]').forEach(btn => {
  btn.addEventListener('click', () => {
    currentPage = parseInt(btn.dataset.page);
    renderCategories();

    // ‚úÖ Inject: toggle class on <body>
    if (currentPage > 1) {
      document.body.classList.add('category-subpage');
    } else {
      document.body.classList.remove('category-subpage');
    }

    // Force DOM update before scrolling (especially important on mobile)
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    });
  });
});

  document.getElementById('prevPage')?.addEventListener('click', () => {
    if (currentPage > 1) {
      currentPage--;
      renderCategories();
      
      // Toggle class on <body> to show/hide hero section
      if (currentPage > 1) {
        document.body.classList.add('category-subpage');
      } else {
        document.body.classList.remove('category-subpage');
      }
      
      // Force DOM update before scrolling (especially important on mobile)
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      });
    }
  });

  document.getElementById('nextPage')?.addEventListener('click', () => {
    const totalPages = Math.ceil(allCategoriesData.length / ITEMS_PER_PAGE);
    if (currentPage < totalPages) {
      currentPage++;
      renderCategories();
      
      // Toggle class on <body> to show/hide hero section
      if (currentPage > 1) {
        document.body.classList.add('category-subpage');
      } else {
        document.body.classList.remove('category-subpage');
      }
      
      // Force DOM update before scrolling (especially important on mobile)
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      });
    }
  });

  // Premium modal handlers with auto-scroll
  function showPremiumModal() {
    const modal = document.getElementById('premiumModal');
    modal.classList.remove('hidden');
    
    // Auto-scroll to modal
    setTimeout(() => {
      const modalWindow = modal.querySelector('.premium-window');
      if (modalWindow) {
        modalWindow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }, 100);
  }

  document.getElementById('closePremiumBtn')?.addEventListener('click', () => {
    document.getElementById('premiumModal').classList.add('hidden');
  });

  document.getElementById('goPremiumBtn')?.addEventListener('click', () => {
    window.location.href = 'premium.html';
  });

  // Search dropdown functionality
  const searchInput = document.getElementById('categorySearchInput');
  const searchDropdown = document.getElementById('searchDropdown');

  // Show all categories when search bar is focused
  searchInput?.addEventListener('focus', () => {
    if (searchInput.value.trim().length === 0) {
      // Show all categories sorted alphabetically
      const allSorted = allCategoriesData.slice().sort((a, b) => a.display.localeCompare(b.display));
      
      searchDropdown.innerHTML = allSorted.map(cat => `
        <div class="search-dropdown-item" data-category="${cat.category}" data-display="${cat.display}" data-emoji="${cat.emoji}" data-premium="${cat.premium}">
          <img src="images/categories/${cat.image}" alt="${cat.display}" />
          <div class="search-dropdown-text">${cat.display}</div>
        </div>
      `).join('');

      searchDropdown.classList.add('active');

      // Add click handlers to dropdown items
      searchDropdown.querySelectorAll('.search-dropdown-item').forEach(item => {
        item.addEventListener('click', () => {
          const category = item.dataset.category;
          const display = item.dataset.display;
          const emoji = item.dataset.emoji;
          const isPremium = item.dataset.premium === 'true';
          
          searchInput.value = '';
          searchDropdown.classList.remove('active');

          if (isPremium && !userIsPremium) {
            showPremiumModal();
          } else {
            openModeSelector(category, display, emoji);
          }
        });
      });
    }
  });

  searchInput?.addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    
    if (query.length === 0) {
      // Show all categories when input is cleared
      const allSorted = allCategoriesData.slice().sort((a, b) => a.display.localeCompare(b.display));
      
      searchDropdown.innerHTML = allSorted.map(cat => `
        <div class="search-dropdown-item" data-category="${cat.category}" data-display="${cat.display}" data-emoji="${cat.emoji}" data-premium="${cat.premium}">
          <img src="images/categories/${cat.image}" alt="${cat.display}" />
          <div class="search-dropdown-text">${cat.display}</div>
        </div>
      `).join('');

      searchDropdown.classList.add('active');

      // Add click handlers
      searchDropdown.querySelectorAll('.search-dropdown-item').forEach(item => {
        item.addEventListener('click', () => {
          const category = item.dataset.category;
          const display = item.dataset.display;
          const emoji = item.dataset.emoji;
          const isPremium = item.dataset.premium === 'true';
          
          searchInput.value = '';
          searchDropdown.classList.remove('active');

          if (isPremium && !userIsPremium) {
            showPremiumModal();
          } else {
            openModeSelector(category, display, emoji);
          }
        });
      });
      return;
    }

    const filtered = allCategoriesData.filter(cat => 
      cat.display.toLowerCase().includes(query)
    ).sort((a, b) => a.display.localeCompare(b.display));

    if (filtered.length === 0) {
      searchDropdown.innerHTML = '<div class="no-results">No categories found</div>';
      searchDropdown.classList.add('active');
      return;
    }

    searchDropdown.innerHTML = filtered.map(cat => `
      <div class="search-dropdown-item" data-category="${cat.category}" data-display="${cat.display}" data-emoji="${cat.emoji}" data-premium="${cat.premium}">
        <img src="images/categories/${cat.image}" alt="${cat.display}" />
        <div class="search-dropdown-text">${cat.display}</div>
      </div>
    `).join('');

    searchDropdown.classList.add('active');

    // Add click handlers to dropdown items
    searchDropdown.querySelectorAll('.search-dropdown-item').forEach(item => {
      item.addEventListener('click', () => {
        const category = item.dataset.category;
        const display = item.dataset.display;
        const emoji = item.dataset.emoji;
        const isPremium = item.dataset.premium === 'true';
        
        searchInput.value = '';
        searchDropdown.classList.remove('active');

        if (isPremium && !userIsPremium) {
          showPremiumModal();
        } else {
          openModeSelector(category, display, emoji);
        }
      });
    });
  });

  // Close dropdown when clicking outside
  document.addEventListener('click', (e) => {
    if (!searchInput.contains(e.target) && !searchDropdown.contains(e.target)) {
      searchDropdown.classList.remove('active');
    }
  });

  // Menu toggle with scroll lock
  const menuToggle = document.getElementById('menuToggle');
  const menuOverlay = document.getElementById('menuOverlay');
  const closeMenu = document.getElementById('closeMenu');
  let scrollPosition = 0;

  menuToggle?.addEventListener('click', () => {
    // Store current scroll position
    scrollPosition = window.pageYOffset;
    // Lock body scroll
    document.body.classList.add('menu-open');
    document.body.style.top = `-${scrollPosition}px`;
    // Show menu
    menuOverlay.classList.add('active');
  });

  function closeMenuHandler() {
    // Unlock body scroll
    document.body.classList.remove('menu-open');
    document.body.style.top = '';
    // Restore scroll position
    window.scrollTo(0, scrollPosition);
    // Hide menu
    menuOverlay.classList.remove('active');
  }

  closeMenu?.addEventListener('click', closeMenuHandler);

  menuOverlay?.addEventListener('click', (e) => {
    if (e.target === menuOverlay) {
      closeMenuHandler();
    }
  });

  // Initialize
  checkPremiumStatus();
</script>

<script type="module">
  import { supabase } from './js/supabase-client.js';

  const signInText = document.getElementById('signInText');
  signInText.textContent = "Loading...";
  signInText.style.opacity = "0.6";

  const { data: { session } } = await supabase.auth.getSession();

if (session && session.user) {
  const userMeta = session.user.user_metadata;
  signInText.textContent =
    userMeta.full_name || userMeta.username || session.user.email || "Account";
  signInText.href = "account.html";
} else {
  signInText.textContent = "Sign In";
  signInText.href = "auth.html";
}
signInText.style.opacity = "1";
</script>

<script type="module">
  import {
    getTodaysDailyChallenge,
    modeDisplayNames,
    categoryDisplayNames,
    categoryEmojis
  } from './js/daily-challenge.js';

  document.addEventListener('DOMContentLoaded', () => {
    const categorySpan = document.getElementById('dailyChallengeCategory');
    const bg = document.getElementById('dailyChallengeBg');

    const today = getTodaysDailyChallenge();

    if (today && categorySpan && bg) {
      const modeName = modeDisplayNames[today.mode] || today.mode.toUpperCase();
      const categoryName = categoryDisplayNames[today.category] || today.category;
      const emoji = categoryEmojis[today.category] || '';

      categorySpan.textContent = `${modeName}: ${categoryName} ${emoji}`;
      bg.style.backgroundImage = `url('images/categories/${today.category}.jpg')`;
    }
  });
</script>

</body>
</html>